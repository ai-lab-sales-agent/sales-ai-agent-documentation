flowchart TD
    TRIGGER([Visitor Asks a Question]) --> KB[Check Knowledge Base]

    KB --> D1{Can answer a question}
    D1 -- "Yes, fully" --> ANSWER[Answer from KB]
    D1 -- "Partially" --> PARTIAL[Answer what agent can]
    D1 -- "Cannot answer" --> CANNOT[Acknowledge gap honestly]

    PARTIAL --> GAP_HANDLER
    CANNOT --> GAP_HANDLER

    GAP_HANDLER[Log gap - internal] --> AN1[Offer alternative + Provide contact email]

    ANSWER --> RESUME
    AN1 --> RESUME

    RESUME[Check conversation_stage] --> RETURN([Resume Discovery from UC1])

    %% Styling
    style TRIGGER fill:#fff3bf,stroke:#e67700
    style ANSWER fill:#b2f2bb,stroke:#2b8a3e
    style PARTIAL fill:#ffd8a8,stroke:#e8590c
    style CANNOT fill:#ffc9c9,stroke:#c92a2a
    style GAP_HANDLER fill:#d0bfff,stroke:#7048e8
    style RETURN fill:#a5d8ff,stroke:#1971c2